% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/crtb_lm_sim.R
\name{crtb_lm_sim}
\alias{crtb_lm_sim}
\title{Simulate Linear Regression with Complementary Resampling  of Tags in Blocks (CRTB)}
\usage{
crtb_lm_sim(
  n = 100,
  sim_iter = 1000,
  B = 1000,
  beta_gen = function() {
     return(list(1, 2, 3))
 },
  gen_ivs = function(n) {
     X1 <- stats::rnorm(n, 0, 1)
     X2 <- 0.6 * X1 + sqrt(1 -
    0.3^2) * stats::rnorm(n)
     epsilon <- stats::rnorm(n)
     return(list(X1 = X1, X2
    = X2, epsilon = epsilon))
 },
  .formula = "Y ~ X1 + X2",
  tie_thresh = 0.5,
  progress = FALSE
)
}
\arguments{
\item{n}{Numeric. Sample size for each simulation iteration. Default is 100.}

\item{sim_iter}{Numeric. Number of simulation iterations. Default is 1000.}

\item{B}{Numeric. Number of bootstrap resamples. Default is 1000.}

\item{beta_gen}{Function. Generates true coefficients for the model. Default
returns a list with beta0 = 1, beta1 = 2, beta2 = 3.}

\item{gen_ivs}{Function. Generates independent variables and error term.
Default generates correlated X1 and X2, and a normal error term.}

\item{.formula}{Character. Formula for the linear regression model.
Default is "Y ~ X1 + X2".}

\item{tie_thresh}{Numeric. Threshold for deciding if there are too many ties
in the resampled data for CRTB. Default is 0.5.}

\item{progress}{Logical. If TRUE, prints progress updates. Default is FALSE.}
}
\value{
A data frame with the following columns:
\item{results}{The resampling method (bootstrap or CRTB)}
\item{avg_bias}{Average bias of the beta1 estimate}
\item{avg_se}{Average standard error of the beta1 estimate}
\item{coverage}{Coverage probability of the confidence interval for beta1}
\item{ci_width}{Average width of the confidence interval for beta1}
\item{converged}{Proportion of CRTB resamples that converged (NA for bootstrap)}
\item{avg_jsd}{Average Jensen-Shannon Divergence for the resamples}
}
\description{
This function performs a simulation study comparing traditional bootstrap
resampling with Complementary Resampling of Tags in Blocks (CRTB) for linear
regression models. It generates data, fits models, and computes various
performance metrics for both resampling methods.
}
\details{
This function performs a simulation study to compare the performance of
traditional bootstrap resampling with Complementary Resampling of Tags in Blocks
(CRTB) for linear regression models. For each simulation iteration, it:
\enumerate{
\item Generates data based on the provided functions
\item Fits a linear regression model
\item Performs both bootstrap and CRTB resampling
\item Computes various performance metrics for both methods
}

The function uses helper functions to calculate Jensen-Shannon Divergence (JSD)
and average pairwise JSD for the resamples.
}
\examples{
# Run a small simulation with default parameters
sim_results <- crtb_lm_sim(n = 50, sim_iter = 5, B = 5)
print(sim_results)

# Run a simulation with custom data generation
custom_beta_gen <- function() list(0, 1, 1)
custom_gen_ivs <- function(n) {
  X1 <- stats::rnorm(n)
  X2 <- stats::rnorm(n)
  epsilon <- stats::rnorm(n, sd = 0.5)
  list(X1 = X1, X2 = X2, epsilon = epsilon)
}
sim_results_custom <- crtb_lm_sim(
  n = 100,
  sim_iter = 5,
  B = 5,
  beta_gen = custom_beta_gen,
  gen_ivs = custom_gen_ivs,
  .formula = "Y ~ X1 + X2"
)
print(sim_results_custom)

}
\seealso{
\code{\link{crtb}} for details on the Complementary Resampling of Tags
in Blocks method.
}
